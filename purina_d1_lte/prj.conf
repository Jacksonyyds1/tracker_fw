#
# Copyright (c) 2020 Nordic Semiconductor ASA
#
# SPDX-License-Identifier: LicenseRef-Nordic-5-Clause
#

# General
CONFIG_LOG=y
CONFIG_LOG_BUFFER_SIZE=2048
CONFIG_HW_ID_LIBRARY=y
CONFIG_ASSERT=y
CONFIG_JSON_LIBRARY=y

# Heap and stacks
CONFIG_HEAP_MEM_POOL_SIZE=8192
CONFIG_MAIN_STACK_SIZE=4096
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=4096

# Network
CONFIG_NETWORKING=y
CONFIG_NET_NATIVE=y
CONFIG_NET_IPV4=y
CONFIG_NET_CONNECTION_MANAGER=y

CONFIG_SMF=y
CONFIG_REBOOT=y

CONFIG_MQTT_HELPER=y
CONFIG_MQTT_HELPER_SEC_TAG=123
CONFIG_MODEM_KEY_MGMT=y 

CONFIG_MQTT_CLEAN_SESSION=y

# TLS
CONFIG_MQTT_LIB_TLS=y
CONFIG_MQTT_HELPER_PORT=8883
CONFIG_MQTT_KEEPALIVE=600
CONFIG_MQTT_HELPER_STACK_SIZE=4096

CONFIG_BOOTLOADER_MCUBOOT=y
CONFIG_MCUBOOT_IMG_MANAGER=y

CONFIG_SPI=n
CONFIG_NRFX_SPIS3=y

# Flash - Used in FOTA, settings and storage for P-GPS.
CONFIG_STREAM_FLASH=y
CONFIG_FLASH=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_FLASH_MAP=y
CONFIG_FCB=y
CONFIG_SETTINGS=y
CONFIG_SETTINGS_FCB=y
CONFIG_MPU_ALLOW_FLASH_WRITE=y


# MCUBOOT
CONFIG_BOOTLOADER_MCUBOOT=y
CONFIG_IMG_MANAGER=y
CONFIG_MCUBOOT_IMG_MANAGER=y
CONFIG_IMG_ERASE_PROGRESSIVELY=y
CONFIG_SECURE_BOOT=y
CONFIG_BUILD_S1_VARIANT=y
CONFIG_PM_EXTERNAL_FLASH_MCUBOOT_SECONDARY=n

CONFIG_ZBUS=y
#CONFIG_ZBUS_RUNTIME_OBSERVERS=y

# # LTE Link Control
CONFIG_LTE_LINK_CONTROL=y
CONFIG_LTE_NETWORK_MODE_LTE_M_GPS=y
# Request eDRX from the network
CONFIG_LTE_EDRX_REQ=y
CONFIG_LTE_PSM_REQ=y
# PSM requested periodic TAU 1 hour, dafault is 00000011
CONFIG_LTE_PSM_REQ_RPTAU="10000010"
CONFIG_LTE_PSM_REQ_RAT="00001000"

# default is 1001
# 0100 is 61.44 seconds
# 0011 is 40.96 seconds
CONFIG_LTE_EDRX_REQ_VALUE_NBIOT="0100"
#default is 1001
CONFIG_LTE_EDRX_REQ_VALUE_LTE_M="0100"
CONFIG_LTE_PTW_VALUE_LTE_M="0011"
CONFIG_LTE_PTW_VALUE_NBIOT="0011"
CONFIG_LTE_LINK_CONTROL=y
CONFIG_PURINA_D1_LTE_GNSS_SAMPLE_MODE_CONTINUOUS=y

CONFIG_REBOOT=y
CONFIG_CJSON_LIB=y

CONFIG_MQTT_HELPER_PAYLOAD_BUFFER_LEN=3072

## debug/demo flags here
CONFIG_PURINA_D1_DISABLE_MODEM_ON_BOOT=n
CONFIG_PURINA_D1_REBOOT_ON_ERROR=n
CONFIG_PM_DEVICE=y
CONFIG_POWEROFF=y
CONFIG_MQTT_HELPER_LOG_LEVEL_DBG=y
CONFIG_NRF_MODEM_LIB_TRACE=n
CONFIG_PURINA_D1_LTE_LOG_LEVEL=4
# CONFIG_SHELL_CMD_BUFF_SIZE=255
# CONFIG_SHELL_CMDS_RESIZE=y
CONFIG_HTTP_PARSER=y
CONFIG_FOTA_DOWNLOAD_LOG_LEVEL_DBG=y
CONFIG_DFU_TARGET_MCUBOOT=y
CONFIG_DOWNLOAD_CLIENT=y
CONFIG_DOWNLOAD_CLIENT_STACK_SIZE=4096
CONFIG_DFU_TARGET=y
#debug
# CONFIG_MQTT_HELPER_STACK_SIZE=4096
# CONFIG_MAIN_STACK_SIZE=4096
# CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=2048

# handle te super long pre-signed FOTA urls
CONFIG_DOWNLOAD_CLIENT_MAX_FILENAME_SIZE=2048
CONFIG_DOWNLOAD_CLIENT_MAX_HOSTNAME_SIZE=256
CONFIG_FOTA_DOWNLOAD=y
CONFIG_FOTA_DOWNLOAD_FILE_NAME_LENGTH=2048
CONFIG_FOTA_DOWNLOAD_HOST_NAME_LENGTH=256
#CONFIG_MQTT_LOG_LEVEL_DBG=y

CONFIG_DK_LIBRARY=y
CONFIG_NET_TCP=y
CONFIG_MQTT_HELPER_RX_TX_BUFFER_SIZE=4096
CONFIG_FOTA_DOWNLOAD_PROGRESS_EVT=y

CONFIG_DEBUG_THREAD_INFO=y

# Enable nRF Cloud assistance for GNSS sample
CONFIG_PURINA_D1_LTE_ASSISTANCE_NRF_CLOUD=y

# P-GPS
CONFIG_NRF_CLOUD_PGPS=y
CONFIG_NRF_CLOUD_PGPS_REPLACEMENT_THRESHOLD=4

# Disable A-GNSS, comment this if you want to use both A-GNSS and P-GPS at the same time
#CONFIG_NRF_CLOUD_AGNSS=n


#CONFIG_SUPL_CLIENT_LIB=y

# Enable SUPL assistance for GNSS sample
CONFIG_PURINA_D1_LTE_ASSISTANCE_SUPL=n
# SUPL client library requires that the newlib C library is used
#CONFIG_NEWLIB_LIBC=y
#CONFIG_NEWLIB_LIBC_FLOAT_PRINTF=y
CONFIG_CBPRINTF_FP_SUPPORT=y

# LTE Link Control
CONFIG_LTE_LINK_CONTROL=y
CONFIG_LTE_NETWORK_MODE_LTE_M_GPS=y
# Request eDRX from the network



# CONFIG_PURINA_D1_LTE_ASSISTANCE_NRF_CLOUD=n
# Enable nRF Cloud assistance for GNSS sample
CONFIG_PURINA_D1_LTE_ASSISTANCE_NRF_CLOUD=y

# P-GPS
CONFIG_NRF_CLOUD_SEC_TAG=16842753
#CONFIG_NRF_CLOUD_CLIENT_ID_SRC_INTERNAL_UUID=y
CONFIG_NRF_CLOUD_CLIENT_ID_SRC_IMEI=y
CONFIG_PURINA_D1_LTE_CLIENT_ID_PREFIX="dog-"
CONFIG_NRF_CLOUD_REST=y
CONFIG_NRF_CLOUD_PGPS=n
CONFIG_NRF_CLOUD_PGPS_REPLACEMENT_THRESHOLD=4
CONFIG_GNSS_PRIORITY_ON_FIRST_FIX=y
#CONFIG_NRF_CLOUD_PGPS_NUM_PREDICTIONS=42 for one week default, 84 is the maximum value indicating two weeks. 
#CONFIG_NRF_CLOUD_AGPS_FILTERED=y  look into this

# Disable A-GNSS, comment this if you want to use both A-GNSS and P-GPS at the same time
# CONFIG_NRF_CLOUD_AGNSS=n
CONFIG_DATE_TIME=y
CONFIG_HEAP_MEM_POOL_SIZE=16384

CONFIG_PURINA_D1_LTE_PRINT_GPS_STATS=n
#CONFIG_MODEM_ANTENNA_GNSS_EXTERNAL=y
#CONFIG_MODEM_ANTENNA_AT_COEX0="AT\%XCOEX0=1,1,1570,1580"

##CONFIG_PURINA_D1_LTE_POWER_SAVING_HIGH
##CONFIG_PURINA_D1_LTE_POWER_SAVING_MODERATE
##CONFIG_MCUBOOT_UTIL_LOG_LEVEL_DBG=y
CONFIG_SERIAL=y
CONFIG_UART_CONSOLE=y
#CONFIG_RTT_CONSOLE=y
#CONFIG_USE_SEGGER_RTT=y
CONFIG_LOG=y
CONFIG_AT_MONITOR_HEAP_SIZE=1024
CONFIG_MCUBOOT_BUILD_STRATEGY_FROM_SOURCE=y


CONFIG_PURINA_D1_LTE_PRINT_GPS_STATS=n

CONFIG_PURINA_D1_LTE_LOW_ACCURACY=n
CONFIG_LTE_NETWORK_MODE_LTE_M_GPS=y
CONFIG_PURINA_D1_LTE_MODE_CONTINUOUS=y
CONFIG_PURINA_D1_LTE_MODE_PERIODIC=n
